<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataDeck - Painel do Administrador</title>
    <link rel="stylesheet" href="css/admin.css">
    <link rel="shortcut icon" href="DataImages/DataDeck_icon.png" type="image/x-icon">
    <script src="https://kit.fontawesome.com/5c5c88297c.js" crossorigin="anonymous"></script>
</head>
<body>

<header class="admin-header">
    <div class="header-title">
        <div class="site-title">DataDeck</div>
        <p class="admin-tag">Painel do Administrador</p>
    </div>
    <div class="header-actions">
        <button id="universal-import-btn" class="btn btn-secondary"><i class="fas fa-file-import"></i> Importar Arquivo</button>
        <button id="sync-btn" class="btn"><i class="fas fa-sync"></i> Sincronizar <span id="local-scripts-count" class="badge">0</span></button>
        <button id="add-term-btn" class="btn btn-secondary"><i class="fas fa-plus"></i> Add Termo</button>
        <button id="add-script-btn" class="btn"><i class="fas fa-plus"></i> Add Script</button>
        <button id="add-user-btn" class="btn btn-secondary"><i class="fas fa-user-plus"></i> Add Login</button>
        <button id="requests-indicator" class="btn btn-secondary"><i class="fas fa-inbox"></i> MailBox <span id="requests-badge" class="badge">0</span></button>
    </div>
    <div class="header-profile">
        <span>Admin</span>
        <button id="logout-btn" class="logout-button" title="Sair">
            <i class="fas fa-sign-out-alt"></i>
        </button>
    </div>
</header>

<main class="admin-dashboard">

    <div class="dashboard-main-col">
        <div class="dashboard-widget widget-table">
            <div class="widget-header">
                <h2><i class="fas fa-file-code"></i> Gerenciar Scripts</h2>
                <input type="search" id="admin-search-scripts" placeholder="Buscar scripts...">
            </div>
            <div class="admin-table-wrapper">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Titulo</th>
                            <th>Descricao</th>
                            <th>Status</th>
                            <th>Favorito</th>
                            <th>Acoes</th>
                        </tr>
                    </thead>
                    <tbody id="scripts-table-body"></tbody>
                </table>
            </div>
        </div>

        <div class="dashboard-widget widget-table">
            <div class="widget-header">
                <h2><i class="fas fa-file-alt"></i> Gerenciar Termos</h2>
                <input type="search" id="admin-search-terms" placeholder="Buscar termos...">
            </div>
            <div class="admin-table-wrapper">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Titulo</th>
                            <th>Variaveis</th>
                            <th>Acoes</th>
                        </tr>
                    </thead>
                    <tbody id="terms-table-body"></tbody>
                </table>
            </div>
        </div>

        <div class="dashboard-widget widget-table">
            <div class="widget-header">
                <h2><i class="fas fa-user-shield"></i> Gerenciar Logins</h2>
                <input type="search" id="admin-search-users" placeholder="Buscar logins...">
            </div>
            <div class="admin-table-wrapper">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Usuário</th>
                            <th>Papel</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body"></tbody>
                </table>
            </div>
        </div>

        <div id="requests-widget" class="dashboard-widget widget-table">
            <div class="widget-header">
                <h2><i class="fas fa-inbox"></i> Requisicoes Pendentes</h2>
                <input type="search" id="admin-search-requests" placeholder="Filtrar... (autor ou status)">
            </div>
            <div class="requests-accordion" id="requests-accordion"></div>
        </div>
    </div>

    <aside class="dashboard-side-col">
        <div class="dashboard-widget">
            <div class="widget-header">
                <h2><i class="fas fa-chart-bar"></i> Estatisticas</h2>
            </div>
            <div class="settings-content">
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value" id="stats-cloud-scripts">...</span>
                        <span class="stat-label">Scripts na Nuvem</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stats-local-scripts">...</span>
                        <span class="stat-label">Scripts Locais</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stats-terms-total">...</span>
                        <span class="stat-label">Termos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stats-users-total">...</span>
                        <span class="stat-label">Logins</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="dashboard-widget">
            <div class="widget-header">
                <h2><i class="fas fa-cog"></i> Configuracoes</h2>
            </div>
            <div class="settings-content">
                <details class="setting-group" open>
                    <summary><h3>Aparencia e Tema</h3></summary>
                    <div class="setting-item-group">
                        <div class="setting-item">
                            <label for="dark-mode-toggle">Modo Escuro</label>
                            <label class="switch">
                                <input type="checkbox" id="dark-mode-toggle">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>
                </details>
                <details class="setting-group">
                    <summary><h3>Configuracoes da Aplicacao</h3></summary>
                    <div class="setting-item-group">
                        <div class="setting-item-column">
                            <label for="iframe-url-input">URL da Pagina de Analise</label>
                            <input type="url" id="iframe-url-input" class="admin-input" placeholder="https://exemplo.com">
                            <button id="save-iframe-url-btn" class="btn btn-small">Salvar URL</button>
                        </div>
                    </div>
                </details>
                <details class="setting-group">
                    <summary><h3>Seguranca</h3></summary>
                    <div class="setting-item-group">
                        <div class="setting-item">
                            <button id="factory-reset-btn" class="btn btn-secondary full-width">Resetar Dados Locais</button>
                        </div>
                    </div>
                </details>
                <details class="setting-group">
                    <summary><h3>Anotacoes</h3></summary>
                    <div class="setting-item-group">
                        <div class="setting-item">
                            <label for="anotacoes-textarea">Bloco de Anotacoes</label>
                            <textarea id="anotacoes-textarea" rows="4" placeholder="Escreva aqui..."></textarea>
                            <div class="actions">
                                <button id="copiar-anotacoes-btn" class="btn btn-small">Copiar</button>
                                <button id="limpar-anotacoes-btn" class="btn btn-secondary btn-small">Limpar</button>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
    </aside>
</main>

<div id="add-script-modal" class="modal-overlay">
    <div class="modal-content">
        <h2>Adicionar Novo Script</h2>
        <form id="add-script-form">
            <div class="form-group">
                <label for="script-title">Titulo</label>
                <input type="text" id="script-title" required>
            </div>
            <div class="form-group">
                <label for="script-description">Descricao</label>
                <textarea id="script-description" rows="2" required></textarea>
            </div>
            <div class="form-group">
                <label for="script-code">Codigo</label>
                <textarea id="script-code" rows="8" required></textarea>
            </div>
            <div class="form-actions">
                <button type="button" id="cancel-btn" class="btn btn-secondary">Cancelar</button>
                <button type="submit" class="btn">Salvar Script</button>
            </div>
        </form>
    </div>
</div>

<div id="add-term-modal" class="modal-overlay">
    <div class="modal-content">
        <h2 id="term-modal-title">Adicionar Termo</h2>
        <form id="add-term-form">
            <div class="form-group">
                <label for="term-title">Titulo do Termo</label>
                <input type="text" id="term-title" required>
            </div>
            <div class="form-group">
                <label for="term-body">Texto do Termo (use "XXX" onde houver variaveis)</label>
                <textarea id="term-body" rows="8" required></textarea>
            </div>
            <div class="form-group">
                <label for="term-variables">Nomes das variaveis (separados por virgula, na ordem em que aparecem)</label>
                <input type="text" id="term-variables" placeholder="Ex: Nome do cliente, CPF">
            </div>
            <div class="form-actions">
                <button type="button" id="cancel-term-btn" class="btn btn-secondary">Cancelar</button>
                <button type="submit" class="btn">Salvar Termo</button>
            </div>
        </form>
    </div>
</div>

<div id="add-user-modal" class="modal-overlay">
    <div class="modal-content">
        <h2 id="user-modal-title">Adicionar Login</h2>
        <form id="add-user-form">
            <div class="form-group">
                <label for="user-display-name">Nome do atendente</label>
                <input type="text" id="user-display-name" required>
            </div>
            <div class="form-group">
                <label for="user-username">Usuário</label>
                <input type="text" id="user-username" required>
            </div>
            <div class="form-group">
                <label for="user-password">Senha</label>
                <input type="text" id="user-password" required>
            </div>
            <div class="form-group">
                <label for="user-avatar">Avatar (URL)</label>
                <input type="url" id="user-avatar" placeholder="https://exemplo.com/foto.png">
            </div>
            <div class="form-group">
                <label for="user-role">Papel</label>
                <select id="user-role">
                    <option value="user">Usuário</option>
                    <option value="admin">Admin</option>
                </select>
            </div>
            <div class="form-actions">
                <button type="button" id="cancel-user-btn" class="btn btn-secondary">Cancelar</button>
                <button type="submit" class="btn">Salvar Login</button>
            </div>
        </form>
    </div>
</div>

<div id="request-modal" class="modal-overlay">
    <div class="modal-content">
        <h2>Detalhes da Requisição</h2>
        <p id="request-info"></p>
        <ul id="request-items-list"></ul>
        <div class="form-actions">
            <button type="button" id="close-request-modal-btn" class="btn btn-secondary">Fechar</button>
            <button type="button" id="approve-request-btn" class="btn">Aprovar e Publicar</button>
        </div>
    </div>
</div>

<div id="fill-term-modal" class="modal-overlay">
    <div class="modal-content">
        <h2>Preencher variaveis</h2>
        <form id="fill-term-form">
            <div id="fill-term-fields"></div>
            <div class="form-actions">
                <button type="button" id="cancel-fill-term-btn" class="btn btn-secondary">Cancelar</button>
                <button type="submit" class="btn">Gerar termo</button>
            </div>
        </form>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore-compat.js"></script>
<script type="module" src="js/admin.js"></script>

</body>
</html>


