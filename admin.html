<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataDeck - Painel do Administrador</title>
    <link rel="stylesheet" href="css/admin.css">
    <link rel="shortcut icon" href="DataImages/DataDeck_icon.png" type="image/x-icon">
    <script src="https://kit.fontawesome.com/5c5c88297c.js" crossorigin="anonymous"></script>
</head>
<body>

<header class="admin-header">
    <div class="header-title">
        <div class="site-title">DataDeck</div>
        <p class="admin-tag">Painel do Administrador</p>
    </div>
    <div class="header-actions">
        <button id="universal-import-btn" class="btn btn-secondary"><i class="fas fa-file-import"></i> Importar Arquivo</button>
        <button id="sync-btn" class="btn"><i class="fas fa-sync"></i> Sincronizar <span id="local-scripts-count" class="badge">0</span></button>
        <button id="add-tool-btn" class="btn btn-secondary"><i class="fas fa-plus"></i> Add Ferramenta</button>
        <button id="add-script-btn" class="btn"><i class="fas fa-plus"></i> Add Script</button>
    </div>
    <div class="header-profile">
        <span>Admin</span>
        <button id="logout-btn" class="logout-button" title="Sair">
            <i class="fas fa-sign-out-alt"></i>
        </button>
    </div>
</header>

<main class="admin-dashboard">

    <div class="dashboard-main-col">
        <div class="dashboard-widget widget-table">
            <div class="widget-header">
                <h2><i class="fas fa-file-code"></i> Gerenciar Scripts</h2>
                <input type="search" id="admin-search-scripts" placeholder="Buscar scripts...">
            </div>
            <div class="admin-table-wrapper">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Título</th>
                            <th>Descrição</th>
                            <th>Status</th>
                            <th>Favorito</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="scripts-table-body"></tbody>
                </table>
            </div>
        </div>

        <div class="dashboard-widget widget-table">
            <div class="widget-header">
                <h2><i class="fas fa-tools"></i> Gerenciar Ferramentas</h2>
                <input type="search" id="admin-search-tools" placeholder="Buscar ferramentas...">
            </div>
            <div class="admin-table-wrapper">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Categoria</th>
                            <th>URL</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="tools-table-body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <aside class="dashboard-side-col">
        <div class="dashboard-widget">
            <div class="widget-header">
                <h2><i class="fas fa-chart-bar"></i> Estatísticas</h2>
            </div>
            <div class="settings-content">
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value" id="stats-cloud-scripts">...</span>
                        <span class="stat-label">Scripts na Nuvem</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stats-local-scripts">...</span>
                        <span class="stat-label">Scripts Locais</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="stats-cloud-tools">...</span>
                        <span class="stat-label">Ferramentas</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="dashboard-widget">
            <div class="widget-header">
                <h2><i class="fas fa-cog"></i> Configurações</h2>
            </div>
            <div class="settings-content">
                <details class="setting-group" open>
                    <summary><h3>Aparência e Tema</h3></summary>
                    <div class="setting-item-group">
                        <div class="setting-item">
                            <label for="dark-mode-toggle">Modo Escuro</label>
                            <label class="switch">
                                <input type="checkbox" id="dark-mode-toggle">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>
                </details>
                <details class="setting-group">
                    <summary><h3>Configurações da Aplicação</h3></summary>
                    <div class="setting-item-group">
                        <div class="setting-item-column">
                            <label for="iframe-url-input">URL da Página de Análise</label>
                            <input type="url" id="iframe-url-input" class="admin-input" placeholder="https://exemplo.com">
                            <button id="save-iframe-url-btn" class="btn btn-small">Salvar URL</button>
                        </div>
                    </div>
                </details>
                <details class="setting-group danger-zone">
                    <summary><h3><i class="fas fa-exclamation-triangle"></i> Zona de Perigo</h3></summary>
                    <div class="setting-item-group">
                        <div class="setting-item">
                            <label>Reset Geral Local</label>
                            <button id="factory-reset-btn" class="btn btn-danger btn-small">Resetar</button>
                        </div>
                    </div>
                </details>
            </div>
        </div>
    </aside>
</main>

<input type="file" id="universal-import-input" style="display: none;" accept=".json">
<input type="file" id="import-theme-input" style="display: none;" accept=".json">

<div id="add-script-modal" class="modal-overlay">
    <div class="modal-content">
        <h2>Adicionar Novo Script</h2>
        <form id="add-script-form">
            <div class="form-group">
                <label for="script-title">Título</label>
                <input type="text" id="script-title" required>
            </div>
            <div class="form-group">
                <label for="script-description">Descrição</label>
                <textarea id="script-description" rows="2" required></textarea>
            </div>
            <div class="form-group">
                <label for="script-code">Código</label>
                <textarea id="script-code" rows="8" required></textarea>
            </div>
            <div class="form-actions">
                <button type="button" id="cancel-btn" class="btn btn-secondary">Cancelar</button>
                <button type="submit" class="btn">Salvar Script</button>
            </div>
        </form>
    </div>
</div>

<div id="add-tool-modal" class="modal-overlay">
    <div class="modal-content">
        <h2 id="tool-modal-title">Adicionar Nova Ferramenta</h2>
        <form id="add-tool-form">
            <div class="form-group">
                <label for="tool-name">Nome da Ferramenta</label>
                <input type="text" id="tool-name" required>
            </div>
            <div class="form-group">
                <label for="tool-url">Link (URL)</label>
                <input type="url" id="tool-url" required>
            </div>
            <div class="form-group">
                <label for="tool-description">Descrição Curta</label>
                <textarea id="tool-description" rows="2" required></textarea>
            </div>
            <div class="form-group icon-upload-group">
                <div class="icon-upload-label-wrapper">
                    <label>Ícone da Ferramenta (opcional)</label>
                    <label for="tool-icon-input" class="btn btn-secondary file-upload-btn">
                        <i class="fas fa-upload"></i> Escolher arquivo
                    </label>
                    <input type="file" id="tool-icon-input" accept="image/*" style="display: none;">
                </div>
                <img id="tool-icon-preview" src="" alt="" class="tool-icon-preview hidden">
            </div>
            <div class="form-group">
                <label for="tool-category">Categoria</label>
                <select id="tool-category" required>
                    <option value="monitoramento">Monitoramento</option>
                    <option value="consulta">Consulta e Dúvidas</option>
                    <option value="atendimento">Atendimento</option>
                </select>
            </div>
            <div class="form-actions">
                <button type="button" id="cancel-tool-btn" class="btn btn-secondary">Cancelar</button>
                <button type="submit" class="btn">Salvar Ferramenta</button>
            </div>
        </form>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore-compat.js"></script>
<script type="module" src="js/admin.js"></script>

</body>
</html>